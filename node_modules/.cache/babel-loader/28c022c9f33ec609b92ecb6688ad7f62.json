{"ast":null,"code":"import _toConsumableArray from \"/Users/chintansawla/Documents/GitHub/purduepal-fe/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\nimport { ActionTypes } from './types';\nvar pageSize = 5;\n\nfunction findValidOptionToHighlight(index, lookupDirection, options, focusDisabled, isOptionDisabled, wrapAround) {\n  if (options.length === 0 || options.every(function (o, i) {\n    return isOptionDisabled(o, i);\n  })) {\n    return -1;\n  }\n\n  var nextFocus = index;\n\n  for (;;) {\n    // No valid options found\n    if (!wrapAround && lookupDirection === 'next' && nextFocus === options.length || !wrapAround && lookupDirection === 'previous' && nextFocus === -1) {\n      return -1;\n    }\n\n    var nextFocusDisabled = focusDisabled ? false : isOptionDisabled(options[nextFocus], nextFocus);\n\n    if (nextFocusDisabled) {\n      nextFocus += lookupDirection === 'next' ? 1 : -1;\n\n      if (wrapAround) {\n        nextFocus = (nextFocus + options.length) % options.length;\n      }\n    } else {\n      return nextFocus;\n    }\n  }\n}\n\nfunction getNewHighlightedIndex(options, previouslyHighlightedIndex, diff, lookupDirection, highlightDisabled, isOptionDisabled, wrapAround) {\n  var maxIndex = options.length - 1;\n  var defaultHighlightedIndex = -1;\n  var nextIndexCandidate;\n\n  if (diff === 'reset') {\n    return defaultHighlightedIndex;\n  }\n\n  if (diff === 'start') {\n    nextIndexCandidate = 0;\n  } else if (diff === 'end') {\n    nextIndexCandidate = maxIndex;\n  } else {\n    var newIndex = previouslyHighlightedIndex + diff;\n\n    if (newIndex < 0) {\n      if (!wrapAround && previouslyHighlightedIndex !== -1 || Math.abs(diff) > 1) {\n        nextIndexCandidate = 0;\n      } else {\n        nextIndexCandidate = maxIndex;\n      }\n    } else if (newIndex > maxIndex) {\n      if (!wrapAround || Math.abs(diff) > 1) {\n        nextIndexCandidate = maxIndex;\n      } else {\n        nextIndexCandidate = 0;\n      }\n    } else {\n      nextIndexCandidate = newIndex;\n    }\n  }\n\n  var nextIndex = findValidOptionToHighlight(nextIndexCandidate, lookupDirection, options, highlightDisabled, isOptionDisabled, wrapAround);\n  return nextIndex;\n}\n\nfunction handleOptionSelection(option, state, props) {\n  var multiple = props.multiple,\n      _props$optionComparer = props.optionComparer,\n      optionComparer = _props$optionComparer === void 0 ? function (o, v) {\n    return o === v;\n  } : _props$optionComparer,\n      _props$isOptionDisabl = props.isOptionDisabled,\n      isOptionDisabled = _props$isOptionDisabl === void 0 ? function () {\n    return false;\n  } : _props$isOptionDisabl;\n  var selectedValue = state.selectedValue;\n  var optionIndex = props.options.indexOf(option);\n\n  if (isOptionDisabled(option, optionIndex)) {\n    return state;\n  }\n\n  if (multiple) {\n    var _ref, _ref2;\n\n    var selectedValues = (_ref = selectedValue) != null ? _ref : []; // if the option is already selected, remove it from the selection, otherwise add it\n\n    var newSelectedValues = selectedValues.some(function (sv) {\n      return optionComparer(sv, option);\n    }) ? selectedValue.filter(function (v) {\n      return !optionComparer(v, option);\n    }) : [].concat(_toConsumableArray((_ref2 = selectedValue) != null ? _ref2 : []), [option]);\n    return {\n      selectedValue: newSelectedValues,\n      highlightedIndex: optionIndex\n    };\n  }\n\n  if (selectedValue != null && optionComparer(option, selectedValue)) {\n    return state;\n  }\n\n  return {\n    selectedValue: option,\n    highlightedIndex: optionIndex\n  };\n}\n\nfunction handleKeyDown(event, state, props) {\n  var options = props.options,\n      isOptionDisabled = props.isOptionDisabled,\n      disableListWrap = props.disableListWrap,\n      disabledItemsFocusable = props.disabledItemsFocusable;\n\n  var moveHighlight = function moveHighlight(diff, direction, wrapAround) {\n    return getNewHighlightedIndex(options, state.highlightedIndex, diff, direction, disabledItemsFocusable != null ? disabledItemsFocusable : false, isOptionDisabled != null ? isOptionDisabled : function () {\n      return false;\n    }, wrapAround);\n  };\n\n  switch (event.key) {\n    case 'Home':\n      return _extends({}, state, {\n        highlightedIndex: moveHighlight('start', 'next', false)\n      });\n\n    case 'End':\n      return _extends({}, state, {\n        highlightedIndex: moveHighlight('end', 'previous', false)\n      });\n\n    case 'PageUp':\n      return _extends({}, state, {\n        highlightedIndex: moveHighlight(-pageSize, 'previous', false)\n      });\n\n    case 'PageDown':\n      return _extends({}, state, {\n        highlightedIndex: moveHighlight(pageSize, 'next', false)\n      });\n\n    case 'ArrowUp':\n      // TODO: extend current selection with Shift modifier\n      return _extends({}, state, {\n        highlightedIndex: moveHighlight(-1, 'previous', !(disableListWrap != null ? disableListWrap : false))\n      });\n\n    case 'ArrowDown':\n      // TODO: extend current selection with Shift modifier\n      return _extends({}, state, {\n        highlightedIndex: moveHighlight(1, 'next', !(disableListWrap != null ? disableListWrap : false))\n      });\n\n    case 'Enter':\n    case ' ':\n      if (state.highlightedIndex === -1 || options[state.highlightedIndex] === undefined) {\n        return state;\n      }\n\n      return handleOptionSelection(options[state.highlightedIndex], state, props);\n\n    default:\n      break;\n  }\n\n  return state;\n}\n\nfunction handleBlur(state) {\n  return _extends({}, state, {\n    highlightedIndex: -1\n  });\n}\n\nfunction handleOptionsChange(options, previousOptions, state, props) {\n  var _options$find;\n\n  var multiple = props.multiple,\n      optionComparer = props.optionComparer;\n  var highlightedOption = previousOptions[state.highlightedIndex];\n  var hightlightedOptionNewIndex = options.findIndex(function (option) {\n    return optionComparer(option, highlightedOption);\n  });\n\n  if (multiple) {\n    var _ref3; // exclude selected values that are no longer in the options\n\n\n    var selectedValues = (_ref3 = state.selectedValue) != null ? _ref3 : [];\n    var newSelectedValues = selectedValues.filter(function (selectedValue) {\n      return options.some(function (option) {\n        return optionComparer(option, selectedValue);\n      });\n    });\n    return {\n      highlightedIndex: hightlightedOptionNewIndex,\n      selectedValue: newSelectedValues\n    };\n  }\n\n  var newSelectedValue = (_options$find = options.find(function (option) {\n    return optionComparer(option, state.selectedValue);\n  })) != null ? _options$find : null;\n  return {\n    highlightedIndex: hightlightedOptionNewIndex,\n    selectedValue: newSelectedValue\n  };\n}\n\nexport default function defaultListboxReducer(state, action) {\n  var type = action.type;\n\n  switch (type) {\n    case ActionTypes.keyDown:\n      return handleKeyDown(action.event, state, action.props);\n\n    case ActionTypes.optionClick:\n      return handleOptionSelection(action.option, state, action.props);\n\n    case ActionTypes.blur:\n      return handleBlur(state);\n\n    case ActionTypes.setControlledValue:\n      return _extends({}, state, {\n        selectedValue: action.value\n      });\n\n    case ActionTypes.optionsChange:\n      return handleOptionsChange(action.options, action.previousOptions, state, action.props);\n\n    default:\n      return state;\n  }\n}","map":{"version":3,"sources":["/Users/chintansawla/Documents/GitHub/purduepal-fe/node_modules/@mui/base/ListboxUnstyled/defaultListboxReducer.js"],"names":["_extends","ActionTypes","pageSize","findValidOptionToHighlight","index","lookupDirection","options","focusDisabled","isOptionDisabled","wrapAround","length","every","o","i","nextFocus","nextFocusDisabled","getNewHighlightedIndex","previouslyHighlightedIndex","diff","highlightDisabled","maxIndex","defaultHighlightedIndex","nextIndexCandidate","newIndex","Math","abs","nextIndex","handleOptionSelection","option","state","props","multiple","optionComparer","v","selectedValue","optionIndex","indexOf","_ref","_ref2","selectedValues","newSelectedValues","some","sv","filter","highlightedIndex","handleKeyDown","event","disableListWrap","disabledItemsFocusable","moveHighlight","direction","key","undefined","handleBlur","handleOptionsChange","previousOptions","_options$find","highlightedOption","hightlightedOptionNewIndex","findIndex","_ref3","newSelectedValue","find","defaultListboxReducer","action","type","keyDown","optionClick","blur","setControlledValue","value","optionsChange"],"mappings":"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","sourcesContent":["import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport { ActionTypes } from './types';\nconst pageSize = 5;\n\nfunction findValidOptionToHighlight(index, lookupDirection, options, focusDisabled, isOptionDisabled, wrapAround) {\n  if (options.length === 0 || options.every((o, i) => isOptionDisabled(o, i))) {\n    return -1;\n  }\n\n  let nextFocus = index;\n\n  for (;;) {\n    // No valid options found\n    if (!wrapAround && lookupDirection === 'next' && nextFocus === options.length || !wrapAround && lookupDirection === 'previous' && nextFocus === -1) {\n      return -1;\n    }\n\n    const nextFocusDisabled = focusDisabled ? false : isOptionDisabled(options[nextFocus], nextFocus);\n\n    if (nextFocusDisabled) {\n      nextFocus += lookupDirection === 'next' ? 1 : -1;\n\n      if (wrapAround) {\n        nextFocus = (nextFocus + options.length) % options.length;\n      }\n    } else {\n      return nextFocus;\n    }\n  }\n}\n\nfunction getNewHighlightedIndex(options, previouslyHighlightedIndex, diff, lookupDirection, highlightDisabled, isOptionDisabled, wrapAround) {\n  const maxIndex = options.length - 1;\n  const defaultHighlightedIndex = -1;\n  let nextIndexCandidate;\n\n  if (diff === 'reset') {\n    return defaultHighlightedIndex;\n  }\n\n  if (diff === 'start') {\n    nextIndexCandidate = 0;\n  } else if (diff === 'end') {\n    nextIndexCandidate = maxIndex;\n  } else {\n    const newIndex = previouslyHighlightedIndex + diff;\n\n    if (newIndex < 0) {\n      if (!wrapAround && previouslyHighlightedIndex !== -1 || Math.abs(diff) > 1) {\n        nextIndexCandidate = 0;\n      } else {\n        nextIndexCandidate = maxIndex;\n      }\n    } else if (newIndex > maxIndex) {\n      if (!wrapAround || Math.abs(diff) > 1) {\n        nextIndexCandidate = maxIndex;\n      } else {\n        nextIndexCandidate = 0;\n      }\n    } else {\n      nextIndexCandidate = newIndex;\n    }\n  }\n\n  const nextIndex = findValidOptionToHighlight(nextIndexCandidate, lookupDirection, options, highlightDisabled, isOptionDisabled, wrapAround);\n  return nextIndex;\n}\n\nfunction handleOptionSelection(option, state, props) {\n  const {\n    multiple,\n    optionComparer = (o, v) => o === v,\n    isOptionDisabled = () => false\n  } = props;\n  const {\n    selectedValue\n  } = state;\n  const optionIndex = props.options.indexOf(option);\n\n  if (isOptionDisabled(option, optionIndex)) {\n    return state;\n  }\n\n  if (multiple) {\n    var _ref, _ref2;\n\n    const selectedValues = (_ref = selectedValue) != null ? _ref : []; // if the option is already selected, remove it from the selection, otherwise add it\n\n    const newSelectedValues = selectedValues.some(sv => optionComparer(sv, option)) ? selectedValue.filter(v => !optionComparer(v, option)) : [...((_ref2 = selectedValue) != null ? _ref2 : []), option];\n    return {\n      selectedValue: newSelectedValues,\n      highlightedIndex: optionIndex\n    };\n  }\n\n  if (selectedValue != null && optionComparer(option, selectedValue)) {\n    return state;\n  }\n\n  return {\n    selectedValue: option,\n    highlightedIndex: optionIndex\n  };\n}\n\nfunction handleKeyDown(event, state, props) {\n  const {\n    options,\n    isOptionDisabled,\n    disableListWrap,\n    disabledItemsFocusable\n  } = props;\n\n  const moveHighlight = (diff, direction, wrapAround) => {\n    return getNewHighlightedIndex(options, state.highlightedIndex, diff, direction, disabledItemsFocusable != null ? disabledItemsFocusable : false, isOptionDisabled != null ? isOptionDisabled : () => false, wrapAround);\n  };\n\n  switch (event.key) {\n    case 'Home':\n      return _extends({}, state, {\n        highlightedIndex: moveHighlight('start', 'next', false)\n      });\n\n    case 'End':\n      return _extends({}, state, {\n        highlightedIndex: moveHighlight('end', 'previous', false)\n      });\n\n    case 'PageUp':\n      return _extends({}, state, {\n        highlightedIndex: moveHighlight(-pageSize, 'previous', false)\n      });\n\n    case 'PageDown':\n      return _extends({}, state, {\n        highlightedIndex: moveHighlight(pageSize, 'next', false)\n      });\n\n    case 'ArrowUp':\n      // TODO: extend current selection with Shift modifier\n      return _extends({}, state, {\n        highlightedIndex: moveHighlight(-1, 'previous', !(disableListWrap != null ? disableListWrap : false))\n      });\n\n    case 'ArrowDown':\n      // TODO: extend current selection with Shift modifier\n      return _extends({}, state, {\n        highlightedIndex: moveHighlight(1, 'next', !(disableListWrap != null ? disableListWrap : false))\n      });\n\n    case 'Enter':\n    case ' ':\n      if (state.highlightedIndex === -1 || options[state.highlightedIndex] === undefined) {\n        return state;\n      }\n\n      return handleOptionSelection(options[state.highlightedIndex], state, props);\n\n    default:\n      break;\n  }\n\n  return state;\n}\n\nfunction handleBlur(state) {\n  return _extends({}, state, {\n    highlightedIndex: -1\n  });\n}\n\nfunction handleOptionsChange(options, previousOptions, state, props) {\n  var _options$find;\n\n  const {\n    multiple,\n    optionComparer\n  } = props;\n  const highlightedOption = previousOptions[state.highlightedIndex];\n  const hightlightedOptionNewIndex = options.findIndex(option => optionComparer(option, highlightedOption));\n\n  if (multiple) {\n    var _ref3;\n\n    // exclude selected values that are no longer in the options\n    const selectedValues = (_ref3 = state.selectedValue) != null ? _ref3 : [];\n    const newSelectedValues = selectedValues.filter(selectedValue => options.some(option => optionComparer(option, selectedValue)));\n    return {\n      highlightedIndex: hightlightedOptionNewIndex,\n      selectedValue: newSelectedValues\n    };\n  }\n\n  const newSelectedValue = (_options$find = options.find(option => optionComparer(option, state.selectedValue))) != null ? _options$find : null;\n  return {\n    highlightedIndex: hightlightedOptionNewIndex,\n    selectedValue: newSelectedValue\n  };\n}\n\nexport default function defaultListboxReducer(state, action) {\n  const {\n    type\n  } = action;\n\n  switch (type) {\n    case ActionTypes.keyDown:\n      return handleKeyDown(action.event, state, action.props);\n\n    case ActionTypes.optionClick:\n      return handleOptionSelection(action.option, state, action.props);\n\n    case ActionTypes.blur:\n      return handleBlur(state);\n\n    case ActionTypes.setControlledValue:\n      return _extends({}, state, {\n        selectedValue: action.value\n      });\n\n    case ActionTypes.optionsChange:\n      return handleOptionsChange(action.options, action.previousOptions, state, action.props);\n\n    default:\n      return state;\n  }\n}"]},"metadata":{},"sourceType":"module"}